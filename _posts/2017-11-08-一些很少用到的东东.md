---
title: php 不常用的东西
date: 2017-11-08 23:29:08
categories:
- php
tags: [php, 叨逼叨]
---

 主要是记录一些不会常用到的东西， 因此可能看起来很无聊，碰到什么就加点什么，所以会一直更新下去。

####  `...`语法糖

> `...`  是php语法糖的一种，很少用，感觉有点鸡肋，他的作用是这样的，在我们给函数传递参数的时候，可以将传递的参数展开，或者收集到一个数组变量中。还是代码好说明问题。

- 声明函数的时候使用，是个索引数组，要是关联就更棒棒了

```PHP
function test(...$names){
  echo '一共有'. count($names) . '个名字' . "\n";
  foreach ($names as $k=>$name){
    echo '第' . $k . '个名字是' . $name ."\n";
  }
}
test('zhangsan', 'lisi', 'wangwu')
```

- 使用函数的时候使用

```php
function test($name, $age){
  echo 'name is ' . $name, ' age is ' . $age;
}
test(...['zhangsan', 32]);
```



#### `register_shutdown_function()`  

> 在php脚本结束时，回调注册的函数，执行顺序是按注册顺序来的。
>
> `register_shutdown_function($callback, $parameters,...)`

```php
function test($name, $age){
  return $name . $age;
}
register_shutdown_function('test', 'zhangsan', 32);
```



#### `json_encode()`

> 不知道为什么会出现这种情况，难道是php默认把字符串0 转换成了数字0， 然后就默认是数组了？？？r

```php
var_dump(json_encode(['1'=>'22', '0'=> '12']));
// {"1":"22","0":"12"}
var_dump(json_encode(['0'=>'22', '1'=> '12']));
// ["22","12"]
echo json_encode([1,2,3], JSON_FORCE_OBJECT);
// {"0":1,"1":2,"2":3}
var_dump(json_encode(['0'=>'22', '2'=> '12']));
// {"0":"22","2":"12"}
var_dump(json_encode(['1'=>'22', '2'=> '12']));
// {"1":"22","2":"12"}
var_dump(json_encode([1=>'22', 2=> '12']));
// {"1":"22","2":"12"}
```

貌似是这样， 只要是以0开头并且是连续的索引数组，结果都是数组，除此之外就是json对象



#### 闭包对象的 `bindTo()`

> 虽然为我们访问对象提供了方便，但是访问外部变量还是需要使用`use` , 具体不清楚怎样使用才能更好
>
> 

```php
class Person{
    private $name = 'page';
    function  hello(){
        echo 'hello' . PHP_EOL;
    }
    function testf(){
        $colus = function (){
            $this->hello();
            echo $this->name . PHP_EOL;
        };
        $colus->bindTo($this);
        $colus();
    }
}

$tes = new Person();
$tes->testf();
```

```php
//居然结果和上面一致， 是时候思考下了
class Person{
    private $name = 'page';
    function  hello(){
        echo 'hello' . PHP_EOL;
    }
    function testf(){
        $colus = function (){
            $this->hello();
            echo $this->name . PHP_EOL;
        };
        $colus->bindTo(new stdClass());
        $colus();
    }
}

$tes = new Person();
$tes->testf();
```

